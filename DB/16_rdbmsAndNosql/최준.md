# 💾 RDBMS & NoSQL

<br>

## 📌 목차

1. 배경지식

2. RDBMS 

3. RDBMS 장단점

4. NoSQL

5. NoSQL 장단점 

6. RDBMS vs NoSQL

<br>

## 📖 배경지식
### 알아둘 것

- SQL은 Structured Query Language의 약자로, 그 자체가 DB가 아니다.

- SQL은 관계형 데이터베이스 관리 시스템 **(RDBMS)의 데이터를 관리하기 위해 설계된 특수 목적의 프로그래밍 언어다.** 

- SQL을 사용하면 관계형 데이터베이스 관리 시스템(RDBMS)에서 데이터를 저장, 수정, 삭제 및 검색 할 수 있다.

- 예전부터 DB는 SQL로 만들어졌기 때문에 SQL이 관계형 DB라는 의미로 사용되는 것이라 추측된다.

### 개요

- 웹 애플리케이션 개발을 위한 첫 걸음을 내딛은 이후에 한가지 선택사항을 마주하게 된다. 

- MySQL와 같은 SQL을 사용할 것인가? 아니면 MongoDB같은 NoSQL을 사용할 것인가?

- 보통 Spring에서 개발할 때는 MySQL을, Node.js에서는 MongoDB를 주로 사용했을 것이다.

- 하지만 그냥 **단순히 프레임워크에 따라 결정하는 것이 아니다.** 

- 프로젝트를 진행하기에 앞서 **적합한 데이터베이스를 택해야 한다.** 

<br>

## 💽 RDBMS 
- `RDB` = 관계 데이터베이스는 키(key)와 값(value)들의 **간단한 관계를 테이블화 시킨 매우 간단한 원칙의 데이터베이스**이다.

- 관계 데이터베이스 모델의 주요 이점은 직관적인 데이터 표현 방법을 제공하고 관련 데이터 포인트에 쉽게 접근할 수 있다는 점이다.

- `RDBMS` = relational database management system란 행과 열을 가지는 표 형식 데이터를 저장하는 형태의 데이터베이스를 가리키며 `SQL`이라는 언어를 써서 조작한다.

- RDBMS 종류에는 `MySQL`, `PostgreSQL`, `Oracle`, `Microsoft SQL Server`, `MariaDB` 등이 있다.

- 관계 데이터베이스의 경우 표준 SQL은 지키기는 하지만, 각각의 제품에 특화시킨 `SQL`을 사용한다.
    - 예를 들어 Oracle의 경우 PL/SQL 이라고 하며 SQL Server에서는 T-SQL, MySQL은 SQL을 사용한다.

<br>

![image](https://velog.velcdn.com/images/mathe1303/post/2feaa84a-345f-4b8d-8840-21f5c402c485/image.png)

<br>

- 관계 데이터베이스에는 `두 가지 주요 특징`이 있다.

  1. 데이터는 `정해진(엄격한) 데이터 스키마` (= structure)를 따라 데이터베이스 테이블에 저장된다.
    
  2. 데이터는 `관계를 통해서 연결된` 여러개의 테이블에 분산된다.

### **1. 엄격한 스키마**
- 데이터는 테이블(table)에 레코드(record)로 저장되며, **각 테이블에는 명확하게 정의된 스키마가 있다.**
    
- 스키마란 어떤 데이터가 테이블에 들어가고 어떤 데이터가 그렇지 않을지를 정의하는 필드(field) 집합을 가르킨다.
    
- 스키마는 **필드의 이름과 데이터 유형으로 정의**된다.
    
- 관계형 데이터베이스에서 **스키마를 준수하지 않는 레코드는 추가할 수 없다.**
    
- 즉, 스키마를 수정하지 않는 이상은 정해진 구조에 맞는 레코드만 추가가 가능한 것이 관계형 데이터베이스의 특징 중 하나다.
    
- 예를 들어, `테이블에서 필드를 넣고 싶다면, 스키마를 뜯어고치지 않는 한 필드를 추가 할 수 없다는 것`이다.

<br>

![image](https://cdn.buttercms.com/Zi194V8cSYKtNWCYKtaP)

<br>

### **2. 관계**
- SQL 기반의 데이터 베이스의 또 다른 중요한 부분은 관계다.
    
- 데이터의 효율적인 관리를 위해 `테이블간의 관계를 구조화하는 것이 중요하다.`
    
- 이러한 **관계를 나타내기 위해 외래 키(Foreign Key) 라는 것을 사용한다.**
    
- 데이터들을 여러개의 테이블에 나누어서, 데이터들의 중복을 피할 수 있다.
    
- 만약 사용자가 구입한 상품들을 나타내기 위해서는, Users(사용자), Products(상품), Orders(주문한 상품) 여러 테이블을 만들어야 하지만, 각각의 테이블들은 다른 테이블에 저장되지 않은 데이터 만을 가지고 있다.
    
- **중복된 데이터가 없다.**
    
- 이런 명확한 구조는 장점이 있다.
    
- 하나의 테이블에서 중복없이 하나의 데이터만을 관리하기 때문에, 다른 테이블에서 부정확한 데이터를 다룰 위험이 없다.
    
- **데이터의 일관성을 보장한다.**

<br>

![image](https://qph.cf2.quoracdn.net/main-qimg-b82480dc5c1937eeb52c127ea682cfa4-lq)

<br>

## 👍👎 RDBMS 장단점
### 👍 RDBMS의 장점
- 명확하게 정의된 스키마, `데이터 무결성 보장`한다. 

- 관계는 각 `데이터를 중복없이 한번만 저장`된다.

- 각 데이터에 맞게 테이블을 나눠서 저장하기 때문에 **데이터 중복을 피해,** 공간 절약한다.

- 정형화된 데이터를 저장하기 때문에 데이터의 형태와 크기를 **미리 정하고 테이블 단위로 구분**하여 데이터를 저장할 수 있다.

- 트랜잭션을 통해 **ACID** (원자성, 일관성, 격리성, 지속성)를 보증하여 안정적인 데이터 관리가 가능하다.

- 조인을 포함해 **복잡한 조건을 포함하는 데이터 검색이 가능**하다. `(복잡한 질의 처리 가능)`

- 관계 데이터베이스는 **데이터 중복성을 줄이고 데이터 무결성을 개선하는 정규화라는 설계 기법을 사용**한다.

### 👎RDBMS의 단점

- 상대적으로 `덜 유연`하다.

- **데이터 스키마는 사전에 계획**되고 알려져야 한다. `(나중에 수정하기가 번거롭거나 불가능 할 수 도 있다.)`

- 관계를 맺고 있기 때문에, **JOIN문이 많은 매우 복잡한 쿼리**가 만들어 질 수 있다.

- 관계로 인한 시스템 복잡도를 고려하여 구조화 해야 한다.

- 시스템이 복잡하면, `query문이 복잡해져 성능이 저하된다.` 

- **수평적 확장이 어렵고**, 대체로 수직적 확장만 가능해 어떤 시점에서 처리 할 수 있는 처리량과 관련하여 성장 한계에 직면하게 된다.

- 데이터베이스 확장 시, scale-up을 주로 이용한다.

- 데이터베이스를 scale-out 할 때 NoSQL에 비해서 번거롭다.

<br>

## ❌ NoSQL
NoSQL(Not only SQL)이라는 슬로건에서 생겨난 데이터베이스이다.

### 👶 왜 NoSQL이 생겼을까?

- 웹이 기하급수적으로 성장하면서, 이미지, 동영상 같은 멀티미디어 데이터뿐 아니라, SNS를 통해 작성되는 자유로운 형태의 텍스트와 로그 기록같은 **비정형 데이터** 가 빠른 속도로 대량 생산되고 있다.

- 이런 환경에서 관계 데이터베이스의 장점을 유지하면 **엄청나게 많은 비용이 든다**.

- 단일 컴퓨터 환경에서 주로 사용되는 관계 데이터베이스는 여러 컴퓨터가 연결되어 하나의 시스템을 구성하는 클러스터 환경에서 효율적으로 동작하도록 설계되지 않았다는 문제점도 지니고 있다.

- 이러한 웹에서 **대량의 비정형 데이터의 저장과 처리를 위해** 관계 데이터베이스를 대신할 새로운 대안으로 제시한 것이 `NoSQL`이다.

- 실제로 **소셜 네트워크 서비스를 제공하는 기업**들을 중심으로 NoSQL 관련 기술이 발전해왔다.

### ❓ NoSQL이란?
- 말그대로 관계형 DB의 반대다.

- `스키마도 없고, 관계도 없다.`

- NoSQL에서는 레코드를 문서(documents)라고 부른다.

- 문서(documents)는 Json과 비슷한 형태로 가지고 있다. 

- 관계형 데이터베이스처럼 여러 테이블에 나누어담지 않고, `관련 데이터를 동일한 '컬렉션'에 넣는다.`

- 여기서 SQL과 핵심적인 차이가 있는데, SQL은 정해진 스키마를 따르지 않으면 데이터 추가가 불가능했다. 

- 하지만 NoSQL에서는 `다른 구조의 데이터를 같은 컬렉션에 추가가 가능`하다.

- 따라서 여러 테이블에 조인할 필요없이 **이미 필요한 모든 것을 갖춘 문서를 작성하는 것이 NoSQL이다.** `(NoSQL에는 조인이라는 개념이 존재하지 않음)`

- 그러면 조인하고 싶을 때 NoSQL은 어떻게 할까?

  - 컬렉션을 통해 데이터를 복제하여 각 컬렉션 일부분에 속하는 데이터를 정확하게 산출하도록 한다.

- 하지만 이러면 `데이터가 중복되어 서로 영향을 줄 위험이 있다.` 

- 실수로 컬렉션 B에서는 데이터를 수정하지 않았는데, 컬렉션 A에서만 데이터를 업데이트 할 위험이 있다. 

- 특정 데이터를 같이 사용하는 모든 컬렉션에서, 똑같은 데이터 업데이트를 수행되도록 해야 한다. 

- 또는 조인을 하고 싶다면 직접 해당 외래키를 검색하여 사용할 수 있겠지만 일반적인 방법은 아니다.

- **그럼에도 불구하고, 이러한 방식의 커다란 장점은 복잡하고 (어떤 순간에는 느린) 조인을 사용할 필요가 없다는 것이다.** 

- 필요한 `모든 데이터가 이미 하나의 컬렉션안에 저장`되어 있기 때문이다. 

- 따라서 `조인을 잘 사용하지 않고 자주 변경되지 않는 데이터일 때` NoSQL을 쓰면 상당히 효율적이다.

## ❗ NoSQL 특징

- NoSQL은 **빠른 속도로 생성되는 대량의 비정형 데이터를 저장하고 처리하기 위해** ACID를 위한 트랜잭션 기능을 제공하지 않는 대신, `저렴한 비용으로 여러 대의 컴퓨터에 데이터를 분산,저장,처리하는 것이 가능`한 데이터베이스다.

- 더 융통성 있는 데이터 모델을 사용하고 스키마 없이 동작하기 때문에 `데이터 구조를 미리 정의할 필요가 없고`, 수시로 그 구조를 바꿀 수 있어서 비정형 데이터를 저장하기에 적합하여 대부분 **오픈 소스**로 제공된다.

- 이처럼 NoSQL은 엄청난 속도로 대량 생산되는 빅데이터를 처리하기 위해, 관계 데이터 모델을 고집하지 않고 미리 정의된 스키마를 사용하지 않는 대신 **클러스터 환경에 맞는 데이터베이스를 만들기 위해 노력해온 결과물**이라 할 수 있다.

- NoSQL을 관계 데이터베이스의 **경쟁자로 볼 필요는 없다**. 관계 데이터베이스와 NoSQL의 **사용 목적이 다르기 때문에** NoSQL이 관계 데이터베이스를 완전히 대체하기는 어렵다.

- `관계 데이터베이스`는 트랜잭션을 통해 일관성을 유지하고 외래키로 테이블 간의 관계를 표현함으로써 조인과 같은 복잡한 질의를 처리할 수 있지만 빠른 속도로 증가하는 대량의 비정형 데이터를 저장하기에는 **확장성 측면에서 비효율적이다**.

- `NoSQL`은 트랜잭션 기능을 제공하지 않고 정해진 스키마도 없기 때문에 자유롭게 구조를 바꾸며 대량의 비정형 데이터를 빠르게 저장하고 처리할 수 있다. 하지만 **데이터 마이닝과 같은 별도의 분석 기술을 적용**해 숨겨진 의미를 찾아내야 한다.

- NoSQL 종류에는 대표적으로 `MongoDB`, `Redis` 등이 있다.

- NoSQL은 분산형 구조를 통해 데이터를 여러 대의 서버에 분산해 저장하고, 분산 시에 데이터를 상호 복제해 특정 서버에 장애가 발생했을 때도 데이터 유실이나 서비스 중지가 없는 형태의 구조다.

- NoSQL 이용한 데이터 저장 방식
    - **Key-value** 방식(Riak, Redis, Voldmort)
    - **Document** 방식(MongoDB, CouchDB)
    - **BigTable** 방식(Hbase, Casandra)
    - **Graph** 방식(Sones, AllegroGraph)

<br>

![image](https://fineproxy.org/wp-content/uploads/2023/05/NoSQL.jpg)

<br>

## 👍👎 NoSQL 장단점 
### 👍 NoSQL의 장점

- 스키마가 없기 때문에, 훨씬 더 `유연`하다. 

- 즉, 언제든지 저장된 데이터를 조정하고 새로운 "필드"를 추가 할 수 있다.

- 데이터는 애플리케이션이 필요로 하는 형식으로 저장 된다. 이렇게 하면 데이터를 읽어오는 `속도가 빨라`진다.

- 수직 및 **수평 확장**이 가능하므로 데이터베이스가 애플리케이션에서 발생시키는 모든 읽기 / 쓰기 요청을 처리 할 수 있다.

- `분산처리와 병렬처리가 가능`하다.

- 관계 설정이 없기에 설계 비용이 감소한다. 

- 수평적 확장(Scale out) 방식으로 비교적 저렴한 비용으로 확장 가능하다. 

- `JOIN에 대한 로직이 필요 없어서 쿼리 로직의 복잡도가 낮다.`

- `Big Data 처리에 효과적`이다. 

- 데이터 모델의 유연한 변화 가능하다. 

- **자주 변경되지 않는 데이터를 저장하기 유리하다.**

- **수평적 확장에 용이**하다. (읽기, 쓰기가 빠르다)

### 👎 NoSQL의 단점

- 유연성 때문에, 데이터 구조 결정을 하지 못하고 미루게 될 수 있다.

- 데이터 중복은 여러 컬렉션과 문서가 (SQL 세계에서 처럼 하나의 테이블에 하나의 레코드가 아니라) 여러 개의 레코드가 변경된 경우 업데이트를 해야 한다.

- 데이터가 여러 컬렉션에 중복되어 있기 때문에, **수정(update)를 해야 하는 경우 모든 컬렉션에서 수행**해야 함을 의미한다. (SQL 세계에서는 중복된 데이터가 없기 때문에 한번만 수행하면 된다.)

- `복잡한 조인 사용이 어렵다.`
    - 기본적으로 조인을 제공하지 않는다. 
    - 조인해서 데이터를 가지고 오는 로직을 구현하려면, Application에서 각 테이블로부터 데이터를 가져와서 합쳐야 한다.

- `데이터의 일관성이 항상 보장되진 않는다.`(중복 데이터 존재 가능) 따라서 중복 저장된 데이터를 똑같이 업데이트 해주는데 시간을 소모한다. 

- 데이터 업데이트 중 장애가 발생하면 데이터 손실 발생한다. 

- 인덱스 구조를 메모리에 저장하기 때문에 많은 인덱스를 사용하면 충분한 메모리가 필요하다. 

<br>

![image](https://blog.kakaocdn.net/dn/dnVwFc/btrmlXt03NL/22db8AI2QB49X7th6glTy0/img.png)

<br>

## 🆚 RDBMS vs NoSQL

- 관계 데이터베이스와 NoSQL 중에 무엇을 선택해야 할지 고민한다면 자신이 데이터베이스를 사용하는 업무 환경과 역량에 가장 적합한 것을 고르면 된다고 조언하고 싶다.

- 즉, `저장될 데이터의 형태와 처리목적에 더 적합`한 것을 선택하면 된다.

### RDBMS 사용이 더 좋을 때

- `관계를 맺고 있는 데이터가 자주 변경되는` 애플리케이션의 경우 좋다. 
  - NoSQL에서는 여러 컬렉션을 모두 수정해야 하기 때문에 비효율적이다. 
    
- **변경될 여지가 없고, 명확한 스키마가** 사용자와 데이터에게 중요한 경우 좋다. 

- 데이터 구조가 극적으로 변경되지 않을 때 좋다. ( 대부분 서비스는 스키마가 유동적인 경우가 거의 없다. )

- 기업의 인사, 회계 자료와 같이 **일관성이 중요하고 조인과 같이 복잡한 질의 처리가 필요**한 정형화된 데이터를 관리하는 용도일 때 더 적합하다.

### NoSQL 사용이 더 좋을 때

- `정확한 데이터 구조를 알 수 없거나 변경/확장 될 수 있는 경우 좋다.`

- `읽기를 자주 하지만, 데이터 변경은 자주 없는 경우 좋다.` (즉, 한 번의 변경으로 수십 개의 문서를 수정할 필요가 없는 경우)

- 데이터베이스를 수평으로 확장해야 하는 경우 좋다. (막대한 양의 데이터를 다뤄야 하는 경우)

- **SNS**를 통해 양산되는 이미지와 텍스트 데이터, **CCTV**를 통해 촬영되는 영상들, 센싱 데이터와 같이 빠른 속도로 엄청난 양이 생성되지만 수정보다는 **삽입 연산 위주의 데이터를 저장하고 관리하는 용도**일 때 더 적합하다.

<br>

![image](https://blog.kakaocdn.net/dn/NkoM0/btqyyV6OUkK/jWK7ow3Nve3kHB4WVViQh1/img.jpg)

<br>

하나의 제시 방법이지 완전한 정답이 정해져 있는 것은 아니다.

RDBMS을 선택해서 복잡한 JOIN문을 만들지 않도록 설계하여 단점을 없앨 수도 있다. 

그리고 NoSQL을 선택해서 중복 데이터를 줄이는 방법으로 설계해서 단점을 없앨 수도 있다.

<br>

다음은 RDBMS와 NoSQL을 몇 가지 측면에서 간단히 비교한 것이다.
    
    
| 구분 | RDBMS | NoSQL |
| --- | --- | --- |
| 처리 데이터 | 정형 데이터 | 정형 데이터, 비정형 데이터 |
| 대용량 데이터 | 대용량 처리 시 성능 저하 | 대용량 데이터 처리 지원 |
| 스키마 | 미리 정해진 스키마가 존재 | 스키마가 없거나 변경이 자유로움 |
| 트랜잭션 | 트랜잭션을 통해 일관성 유지를 보장함 | 트랜잭션을 지원하지 않아 일관성 유지를 보장하기 어려움 |
| 검색 기능 | 조인 등의 복잡한 검색 기능 제공 | 단순한 데이터 검색 기능 제공 |
| 확장성 | 클러스터 환경에 적합하지 않음 | 클러스터 환경에 적합함 |
| 라이선스 | 고가의 라이선스 비용 | 오픈소스 |
| 대표적 사례 | MySQL, PostgreSQL, Oracle, Microsoft SQL Server, MariaDB | MongoDB, Redis |


<br>

## 📍 references
- [RDBMS, RDBMS 장단점, NoSQL, RDBMS vs NoSQL](https://github.com/devSquad-study/2023-CS-Study/blob/main/DB/db_rdbms_and_nosql.md)

- [RDBMS, NoSQL, NoSQL 장단점](https://github.com/jobhope/TechnicalNote/blob/master/database/RDBMSAndNoSQL.md)

- [배경 지식, RDBMS, NoSQL, RDBMS vs NoSQL](https://github.com/gyoogle/tech-interview-for-developer/blob/master/Computer%20Science/Database/SQL%EA%B3%BC%20NOSQL%EC%9D%98%20%EC%B0%A8%EC%9D%B4.md)

- [RDBMS 장단점](https://github.com/devham76/tech-interview-study/blob/master/contents/db.md#NoSQL%EC%9D%B4%EB%9E%80?-%EA%B8%B0%EC%A1%B4RDBMS%EC%99%80-%EB%8B%A4%EB%A5%B8%EC%A0%90%EC%9D%80)

- [배경 지식, RDBMS, RDBMS 장단점, NoSQL, NoSQL 장단점](https://github.com/Songwonseok/CS-Study/blob/main/Database/SQL%20vs%20NoSQL.md)

- [RDBMS, RDBMS 장단점, NoSQL, NoSQL 장단점, RDBMS vs NoSQL](https://github.com/NKLCWDT/cs/blob/main/Database/RDBMSAndNoSQL.md)
