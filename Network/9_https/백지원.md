# HTTPS

## 들어가기 앞서

우리는 웹으로 많은 일을 할 수 있습니다. 웹에서는 내가 원하는 정보를 열람하는 것뿐만 아니라, 내가 입력한 정보를 웹 사이트를 운영하는 회사의 시스템으로 전달하는 경우도 많습니다. 예를 들면, 포털 사이트에 내 계정 정보를 입력하고 로그인한다거나, 은행 사이트에 접속하여 계좌 정보를 조회해 이체하는 경우가 이에 해당합니다. 만약 누군가가 이러한 개인 정보를 몰래 보거나 악용한다면, 안전한 웹 서핑은 불가능할 것입니다.

HTTPS는 웹에서 정보를 보호하기 위한 가장 기본적인 기술이라고 할 수 있습니다. 지금부터 HTTPS가 어떤 보안 기술로 브라우저와 웹 서버 사이의 통신을 지킬 수 있는지 알아보겠습니다.

<br>

# 🔒  HTTPS (Hypertext Transfer Protocol Secure)

![Alt text](https://yozm.wishket.com/media/news/1852/image001.png)

HTTPS는 안전한 통신을 위해 정보를 `암호화`합니다. 암호화란 일반적인 평문을 알아볼 수 없도록 암호화하여 암호문으로 만드는 과정입니다. 개인 정보가 담긴 평문을 암호화하고, 이렇게 만들어진 암호문을 상대방에게 전달하면, 상대방은 이를 다시 복호화 하여 원래의 평문으로 열람할 수 있습니다. 인터넷 콘텐츠를 전달하는 TCP 프로토콜의 일종인 HTTP에 S(Secure) 기능을 더한 것입니다.

HTTPS의 원천 기술로는 SSL(Secure Socket Layer)과 TLS(Transport Layer Security) 전송 기술이 있습니다. 단어에서 알 수 있듯, 안전한 계층을 웹 통신에 추가하는 방식입니다. 이 기술을 수행하기 위해 웹 서버에 설치하는 것이 SSL/TLS 인증서입니다. TLS는 SSL의 개선 버전으로, 최신 인증서는 대부분 TLS를 사용하지만, 편의적으로 SSL 인증서라고 말합니다. 웹 브라우저는 공신력 있는 인증서의 정보를 브라우저 내부에 보관하고 있으며, 접속하는 웹 사이트에 믿을만한 인증서가 설치되어 있는지 확인합니다.

HTTPS는 안전한 데이터의 전달이 브라우저와 웹 서버 사이의 전달 구간에서 이루어지기 때문에, 보안 채널(secure channel), 전송 보안(secure transit)이라고 부르기도 합니다.

<br>

## ✔️  TCP 연결의 보안: TLS

SSL 프로토콜, TLS 프로토콜 헷갈릴 수 있습니다.

SSL 프로토콜은 원래 넷스케이프(Netscape)가 고안했지만 넷스케이프가 SSL 통제권을 IETF[RFC 4346]로 넘기면서 TLS로 표준화되었습니다.

즉, SSL 프로토콜에서 TLS 프로토콜로 발전했다고 보면 되겠습니다.

### 안전한 통신이란

**안전한 통신**에는 3가지 특성이 요구됩니다.

1. `기밀성` : 송신자와 지정된 수신자만이 전송되는 메시지 내용을 이해할 수 있어야 한다.<br>
>기밀성이 지켜지지 않는다면 침입자가 메시지를 가로채서 내용을 열람하고 민감한 정보가 노출될 수 있습니다.
2. `메시지 무결성` : 통신하는 내용이 전송 도중에 변경되지 않아야 한다.<br>
>메시지 무결성이 지켜지지 않은 경우 침임자가 내용을 중간에서 가로채 수정할 수 있습니다.
3. `종단점 인증` : 송신자와 수신자는 통신에 참여하는 상대방이 실제 누구인지 확인하기 위해 상대방의 신원을 확인할 수 있어야 한다.<br>
>종단점 인증이 불가능한 경우 누군가 사용자가 접속하려는 사이트와 유사한 사이트를 만들어 사용자로부터 돈, 개인 정보 등을 얻고 달아날 수 있습니다.

TLS는 이러한 위험을 없애고 TCP를 향상함으로써 문제를 해결합니다.

## ✔️ 암호화 방식

### 1. 대칭키 암호화

![](https://velog.velcdn.com/images/qorjiwon/post/0f77b294-8e53-435b-a0e9-736fa46f58da/image.png)


> 암호화를 할 때와 복호화를 할 때 **같은 암호키**를 사용하는 알고리즘

대칭키 암호화 방식은 대문의 열쇠와 같습니다. 자물쇠를 잠근 열쇠로 그 자물쇠를 다시 열 수 있습니다.

하지만 그 키를 잃어버린다면 누군지 모르는 사람이 우리 집에 문을 열 수 있듯, 대칭키가 공개된다면 제 3자가 데이터를 열어볼 수 있기 때문에 위험합니다.

### 2. 공개키 암호화

![](https://velog.velcdn.com/images/qorjiwon/post/eff3f106-251a-4db0-8c3e-8be6e94ecbaf/image.png)

> 메시지 암호화 하는 키와 복호화 하는 **키가 다른** 알고리즘 (공개키와 비공개키)

송신자와 수신자는 각각 암호화 키와 복호화 키 두 개를 가지는데, 이것을 <u>키페어(key pair)</u>라고 부릅니다.

1. **공개키** (public key)
2. **비공개키** = 개인키 = 비밀키 (private key)

#### 간단한 이해

공개키 암호화 방식은 암호학적으로 연관된 두 개의 키를 만들어서 하나는 자기가 안전하게 보관하고 다른 하나는 상대방에게 공개합니다. 수신자가 송신자에게 공개키를 주면, 송신자는 공개키로 문서를 암호화하여 수신자에게 전송합니다. 그럼 수신자는 개인키로 문서를 복호화하여 내용을 확인할 수 있게 됩니다.

<br>

### ✔️  TLS  핸드셰이크(handshake)

TLS를 어떻게 사용하는지 큰 그림을 이해하기 위해서 아래 단순화된 그림으로 살펴봅시다.

이 과정은 세 단계로 나눠져 있습니다.

```
1. 핸드셰이크(handshake)
2. 키 유도(key derivation)
3. 데이터 전송(data transfer)
```

서버는 개인키, 공개키를 가지고 있으며 신뢰할 수 있는 CA 기업에 공개키 관리를 부탁하며 계약을 합니다.

\* CA(Certificate Authority) : 공개키를 저장해주는 신뢰성이 검증된 민간기업

```
a) TCP 연결을 설립한다.

b) 연결이 설립되면 클라이언트는 헬로(hello)메세지를 보내고, 서버는 공개키를 담은 인증서로 응답한다.

(이때 인증서는 CA 인증을 받았기 때문에, 클라이언트는 인증서 내 공개키가 서버의 것이라는 것을 신뢰할 수 있다.)

c) 클라이언트는 MS(Master Secret)을 서버의 공개키로 암호화하여 보내면, 서버는 개인키로 복호화한다.
```

TLS 핸드셰이크 과정이 끝나고 HTTPS 통신을 시작합니다.

<br>

이 과정에서 TLS 인증서에는 대칭키 방식과 공개키 방식 모두 사용합니다. 모든 것을 공개키 방식으로 한다면 웹 서버와 브라우저에 많은 부담이 되기 때문입니다. 그래서 TLS 핸드셰이크 과정은 공개키 방식, 그 이후의 HTTPS 통신은 대칭키 방식을 사용합니다.

<br>

---

### 📌 Reference

- [안전한 웹을 위해 HTTPS 이해하기: ①HTTPS의 작동 원리](https://yozm.wishket.com/magazine/detail/1852/)

- [[웹개발자 필수2] HTTPS 작동 원리](https://hello-judy-world.tistory.com/201)

- [공개키 암호화 방식](https://namu.wiki/w/%EA%B3%B5%EA%B0%9C%ED%82%A4%20%EC%95%94%ED%98%B8%ED%99%94%20%EB%B0%A9%EC%8B%9D)

- [[Web] HTTP와 HTTPS의 개념 및 차이점](https://mangkyu.tistory.com/98)