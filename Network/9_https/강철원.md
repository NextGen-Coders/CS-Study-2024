# 📖 HTTPS

웹에서는 내가 원하는 정보를 열람하는 것뿐만 아니라, 내가 입력한 정보를 웹사이트를 운영하는 회사의 시스템으로 전달하는 경우가 많습니다. 예를 들어, 포털 사이트에 내 계정 정보를 입력하고 로그인하거나, 은행 사이트에 접속하여 계좌 정보를 조회해 이체하는 경우가 이에 해당합니다. 만약 누군가가 이러한 개인 정보를 몰래 보거나, 이를 다시 악용한다면 더 이상 안전한 웹 서핑은 불가능합니다.  

이때 웹이서 정보를 보호하기 위한 가장 기본적인 기술이 `HTTPS`라고 할 수 있습니다. 

<br>

## 1️⃣ HTTPS란?

하이퍼텍스트 전송 프로토콜 보안(HTTPS)은 웹브라우저와 웹 사이트 간에 데이터를 전송하는 데 사용되는 기본 프로토콜인 HTTP의 보안버전입니다. HTTPS는 데이터 전송의 보안을 강화하기 위해 암호화됩니다. 이는 사용자가 은행 계좌, 이메일 서비스, 의료 보험 공금자에로그인하는 등 중요한 데이터를 전송할 때 특히 중요합니다.

모든 웹 사이트, 특히 로그인 자격 증명이 필요한 웹 사이트는 HTTPS를 사용해야 합니다. 크롬 등 최신 웹 브라우저에서는 HTTPS를 사용하지 않는 웹 사이트가 HTTPS를 사용하는 웹 사이트와 다르게 표시됩니다. URL 표시줄에서 웹 페이지가 HTTPS를 사용하는 웹 사이트와 다르게 표시됩니다.

<img width="652" alt="image" src="https://github.com/NextGen-Coders/CS-Study-2024/assets/76567238/5bebba3d-8fe8-4005-8630-6b999ca741a8">
<출처: SEMrush>

웹은 안전한 통신을 위해 정보를 암호화합니다. 암호화란 일반적인 평문을 알아볼 수 없도록 암화화하여 암호문을 만드는 과정입니다.
개인 정보가 담긴 평문을 암호화하고, 이렇게 만들어진 암호문을 상대방에게 전달하면, 상대방은 이를 다시 복호화 하여 원래의 평문으로 열람할 수 있습니다. 

이와 같은 과정을 웹 블우저와 웹 서버에 사용하는 대표적인 기술이 바로 HTTPS(HyperText Transfer Protocol Secure)입니다. 인터넷 콘텐츠를 전달하는 TCP 프로토콜의 일종인 HTTP에 S(Secure) 기능을 더한 것 입니다 .

HTTPS의 원천 기술로는 SSL(Secure Socket Layer)과 TLS(Transport Layer Security) 전송 기술이 있습니다. 단어에서 알 수 있듯이 안전한 계층(layer)을 웹 통신에 추가하는 방식입니다. 이 기술을 수행하기 위해 웹서버에 설치하는 것이 SSL/TLS 인증서입니다. 
TSL은 SSL의 개선 버전으로, 최신 은정서는 대부분 TLS를 사용하지만, 편의적으로 SSL 인증서라고 말합니다. 웹 브라우저는 공신력 잇는 인증서의 정보를 브라우저 내부에 보관하고 있으며, 접속하는 웹사이트에 믿을만한 인증서가 설치되어 있는지 확인합니다.

HTTPS는 안전한 데이터의 전달이 브라우저와 웹 서버 사이의 전달 구간에서 이루어지 때문에, 보안 채널(secure channel), 전송 보안(secure transit)이라고 부르기도 합니다.

<br>

## 2️⃣ HTTPS와 HTTP의 차이점

### 🎾 보안

사용자와 웹사이트 소유자 모두에게 HTTP 대신 HTTPS를 사용하면 더 안전하다는 주요한 이점이 있습니다. 다음을 포함하여 데이터를 안전하게 전송하려는 경우 HTTPS가 중요합니다.
- 신용 카드 정보
- 전자상거래 사이트의 결제, 주소, 주문 세부정보
- 온라인 서비스에 로그인하기 위한 사용자 이름 및 비밀번호
- 이름, 생년월일, 주소를 포함한 개인 식별 정보(PII)
- 기밀 비즈니스 정보 또는 정부 데이터와 같은 민감한 정보
- 보호 대상 건강 정보 및 기타 민감한 의료 기록

HTTPS를 사용하면 인증이 필요하지 않은 암호화되지 않은 Wi-Fi 액세스 포인트와 같이 보안되지 않은 네트워크를 대상으로 하는 일종의 공격인 MITM 공격을 방지하는 데 도움이 될 수 있습니다. 이러한 공격은 발신자와 수신자에 대한 인증을 우회합니다. 그러나 TLS는 적어도 하나의 당사자에 대한 인증을 요구하므로 이러한 공격이 불가능합니다.

사람들은 일반적으로 통신 보안을 유지하려는 경우 커피숍이나 공항과 같은 공용 Wi-Fi 네트워크를 사용하지 말 것을 권고받습니다. 그렇게 하면 데이터 유출이나 사이버 공격 의 위험이 높아질 수 있습니다 .

그러나 HTTPS를 통해 전송되는 모든 것은 암호화됩니다. 따라서 위협 행위자가 사용자 데이터의 손이 바뀌는 것을 지켜보고 있더라도 HTTPS 및 자물쇠 아이콘으로 표시되는 보안 TLS 연결이 있는 한 안전합니다.

## 🎾 검색 엔진 최적화(SEO)의 장점
HTTPS는 검색 엔진 최적화(SEO) 이점을 제공합니다. 2014년에 Google은 웹사이트 보안이 최우선 과제라고 밝혔습니다 . Google은 인터넷을 더욱 안전하게 만들기 위해 모든 곳에서 HTTPS 구현을 장려하고 HTTPS를 순위 신호로 사용하기 시작했습니다.

시간이 지남에 따라 데이터 보안의 중요성을 강화하기 위해 알고리즘을 변경했습니다. 웹사이트가 개인 정보를 수집하는지 여부에 관계없이 Google은 HTTP만 사용하는 사이트보다 보안 연결을 사용하는 사이트를 선호합니다.

2017년부터 Google Chrome과 같은 브라우저는 모든 사이트에 HTTPS를 통한 암호화 기능을 요구함으로써 온라인 신뢰도를 높이기로 결정했습니다. 이를 수행하지 못하는 사이트는 일반적으로 사용자에게 경고를 생성합니다.

따라서 HTTPS URL은 검색 순위에서 사이트의 성능을 높일 수 있는 반면, 안전하지 않은 사이트는 불이익을 받습니다. SSL 인증서는 더 큰 SEO 전략의 일부일 뿐이지만 여전히 중요한 요소입니다.

### 📌 비교 요약
| Feature         | HTTP                                                                             | HTTPS                                                                                                               |
|-----------------|----------------------------------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------|
| **의미 (Meaning)**          | Hypertext Transfer Protocol                                                      | Hypertext Transfer Protocol Secure                                                                                  |
| **기본 프로토콜 (Base Protocol)** | HTTP/1과 HTTP/2는 TCP/IP를 사용합니다. HTTP/3은 QUIC 프로토콜을 사용합니다.          | HTTP 요청 및 응답을 추가로 암호화하기 위해 SSL/TLS와 함께 HTTP/2 사용                                               |
| **포트 (Port)**            | 기본 포트 80                                                                      | 기본 포트 443                                                                                                        |
| **용도 (Usage)**           | 이전 텍스트 기반 웹 사이트                                                         | 모든 최신 웹 사이트                                                                                                  |
| **보안 (Security)**         | 추가 보안 기능 없음                                                               | 퍼블릭 키 암호화에 SSL 인증서 사용                                                                                   |
| **이점 (Advantages)**       | 인터넷을 통한 통신 지원        |  웹 사이트에 대한 권위, 신뢰성 및 검색 엔진 순위 개선 

<br>

## 3️⃣ HTTPS를 사용하는 이유는 무엇일까요?

HTTPS는 이제 사용자가 민감한 정보를 보호하는 가장 안전한 방법이므로 웹의 모든 활동에 선호되는 프로토콜입니다.

HTTPS는 사용자 정보를 요청하는 웹사이트에만 중요한 것이 아닙니다.  공격자는 사용자로부터 직접 전송된 정보 외에도 보안되지 않은 연결에서 행동 및 식별 데이터를 추적할 수도 있습니다.

HTTPS는 웹사이트 사용자로부터 신회를 구착하여 SSL 인증서와 비교하여 도메인 이름을 다시 확인할 수 있도록 합니다.  프로토콜은 SSL/TLS 인증을 통해 모든 클라이언트-서버 통신을 암호화하므로 공격자가 데이터를 가로챌 수 없습니다. 즉, 사용자는 안전하게 개인 정보를 입력할 수 있습니다.

사용자 신뢰를 얻는 것은 전자상거래 상점과 같은 온라인 비즈니스 에 특히 중요합니다 . 잠재 고객은 결제 세부 정보가 손상되지 않는다는 확신이 필요합니다. HTTPS가 없는 웹사이트 소유자는 고객의 개인정보 보호는 물론 자신의 평판까지 위험에 빠뜨리게 됩니다. 공격자는 보안되지 않은 연결을 통해 고객 정보에 쉽게 접근할 수 있습니다. 이러한 위반은 신뢰 상실로 인해 사용자가 향후 비즈니스와의 거래를 방해할 수 있습니다.

HTTPS는 최고의 표준 프로토콜로 널리 알려져 있으므로 웹 브라우저에서는 이를 주목해야 합니다. 예를 들어 Google Chrome은 HTTP 웹사이트에 플래그를 지정 하고 Mozilla Firefox는 이제 'HTTPS 전용 모드'를 제공합니다. Google의 검색 엔진 알고리즘은 또한 결과에서 HTTPS 페이지를 선호하는 HTTP 웹사이트에 불이익을 줍니다 . 따라서 사이트 소유자는 HTTPS로 전환하여 SEO를 개선 할 수 있습니다.

2015년 HTTP/2(프로토콜 개정)가 출시되면서 브라우저는 HTTP보다 HTTPS를 더욱 우선시했습니다. HTTP/2 는 다양한 새로운 기능을 통해 더 빠른 웹 검색과 향상된 사용자 경험을 제공합니다 . 이제 대부분의 브라우저는 HTTPS를 사용하는 웹 페이지에서만 HTTP/2 사용을 허용합니다. 이 업데이트는 HTTP 사이트 소유자가 이러한 기능을 활용하려는 경우 강제로 전환하도록 합니다.

<br>

## 4️⃣ HTTPS 프로토콜의 작동 방식

HTTP는 암호화되지 않은 데이터를 전송합니다. 즉, 브라우저에서 전송된 정보를 제3자가 가로채고 읽을 수 있습니다. 이는 이상적인 프로세스가 아니었기 때문에, 통신에 또 다른 보안 계층을 추가하기 위해 HTTPS로 확장되었습니다. HTTPS는 HTTP 요청 및 응답을 SSL 및 TLS 기술에 결합합니다.

HTTPS 웹 사이트는 독립된 인증 기관(CA)에서 SSL/TLS 인증서를 획득해야 합니다. 이러한 웹 사이트는 신뢰를 구축하기 위해 데이터를 교환하기 전에 브라우저와 인증서를 공유합니다. SSL 인증서는 암호화 정보도 포함하므로 서버와 웹 브라우저는 암호화된 데이터나 스크램블된 데이터를 교환할 수 있습니다. 프로세스는 다음과 같이 작동합니다.

1. 사용자 브라우저의 주소 표시줄에 https:// URL 형식을 입력하여 HTTPS 웹 사이트를 방문합니다.
2. 브라우저는 서버의 SSL 인증서를 요청하여 사이트의 신뢰성을 검증하려고 시도합니다.
3. 서버는 퍼블릭 키가 포함된 SSL 인증서를 회신으로 전송합니다.
4. 웹 사이트의 SSL 인증서는 서버 아이덴티티를 증명합니다. 브라우저에서 인증되면, 브라우저가 퍼블릭 키를 사용하여 비밀 세션 키가 포함된 메시지를 암호화하고 전송합니다.
5. 웹 서버는 개인 키를 사용하여 메시지를 해독하고 세션 키를 검색합니다. 그런 다음, 세션 키를 암호화하고 브라우저에 승인 메시지를 전송합니다.
6. 이제 브라우저와 웹 서버 모두 동일한 세션 키를 사용하여 메시지를 안전하게 교환하도록 전환합니다.

<br>

## 5️⃣ 배경지식

### 📌 TSL이란?

TLS는 전송 계층 보안을 의미합니다. 이는 HTTPS를 암호화하는데 도움이 되며 이메일 및 기타 프로토콜을 보호하는 데 사용될 수 있습니다. 이는 데이터가 전송된 이후 변조되지 않았는지, 통신이 실제 전달된 사람과 이루어졌는지 확인하고, 개인 데이터가 보이지 않도록 방지하는 암호화 기술을 사용합니다. 

TLS 암호화를 사용하는 통신 세션을 시작하는 프로세스인 TLS 핸드셰이크로 모든것이 시작됩니다.  여기에서 인증이 이루어지고 세션 키가 생성됩니다. 두 장치가 통신할 때 함께 작동하는 두 개의 서로 다른 키에서 새로운 세션 키가 생성됩니다. 그 결과 더 깊고 암호화된 통신이 가능해졌습니다.

<img width="645" alt="image" src="https://github.com/NextGen-Coders/CS-Study-2024/assets/76567238/98803254-3087-4ea0-bf68-c001c6233515">
<출처: Semrush.com>


### 📌 SSL/TLS 핸드셰이크 전체 흐름


<img width="735" alt="image" src="https://github.com/NextGen-Coders/CS-Study-2024/assets/76567238/a19b9cc5-ecbd-480c-82ca-62e369994870">

### 📌 대칭/비대칭 키 암호화

- 대칭 키 암호화 방식
    - 대칭 키 암호화 방식은 서버와 클라이언트가 동일한 키를 사용하는 암호화 방식입니다.
    - 클라이언트는 암호화키 를 사용하여 데이터를 암호화하고, 암호화된 데이터와 키를 서버에 전달합니다. 
    - 서버는 암호화된 데이터를 전달 받은 키로 복호화한다. 마치 엑셀파일을 비밀번호로 암호화하고, 비밀번호를 알려주는 것과 같습니다. 
    - 간편한 방 식이지만, 키를 전달하는 과정에서 제삼자에게 노출될 수 있습니다.
- 비대칭 키 암호화 방식
    - 비대칭 키 암호화 방식은 암호화와 복호화에 서로 다른 키를 사용하는 방식입니다.
        - 대표적인 예가 인증서이다.
    - 서버는 Public키와 Private키 쌍을 만든다. Private키는 자신이 소유하고, Public키를 만천하에 공개합니다.
    - 클라이언트는 서버의 Public키를 사용하여 데이터를 암호화하고, 이를 서버에 전달합니다. 
    - 이때 별도의 키를 전달할 필요는 없다. 서버는 자신의 Private키로 복호화를 진행합니다. 참고로, Private키로 암호화하고 Public으로 복호화하여 사용자를 인증하는 디지털서명도 비대칭 키 암호화의 좋은 예입니다.
    - 비대칭 키 암호화 방식은 복호화에 필요한 키가 공개되지 않기에 안전합니다. 하지만 과정이 복잡하여 처리 속 도가 느립니다. 이는 Public키와 Private키의 조합을 검증하기 위한 수학적 계산이 생각보다 많은 부하를 발 생시키기 때문입니다.

SSL/TLS 핸드 셰이크에서는 위의 2가지 방식을 혼합하여 속도와 보안을 동시에 챙겼습니다.
먼저, 속도를 높이기 위해서 데이터 암/복호화는 공통키(대칭키)를 사용한다. 앞선 그림에서 Session 키와 MAC키가 바로 대칭키입니다. 하지만 대칭키를 그냥 주고받으면 위험하기 때문에, 대칭키를 만들기 위한 재료를 보낼 때 비대칭 키 암호화 방식을 사용합니다. 클라이언트가 Pre Master Secret을 보낼 때 Public키로 암호화 하는데, 이게 비대칭 키 방식입니다.

요약하자면, SSL/TLS는 비대칭 키 암호화 방식을 사용하여 공통키의 재료를 전달하고, 공통키를 각자 만들어 데이터를 암호화하는 데 사용합니다.

---

<br>

### 📚 Reference

- [HTTPS란 무엇입니까?](https://www.cloudflare.com/ko-kr/learning/ssl/what-is-https/)
- [TLS 핸드셰이크에서는 어떤 일이 발생하나요?](https://www.cloudflare.com/learning/ssl/what-happens-in-a-tls-handshake/)
- [안전한 웹을 위해 HTTPS 이해하기](https://yozm.wishket.com/magazine/detail/1852/)
- [HTTPS 작동 설명](https://www.geeksforgeeks.org/explain-working-of-https/)
- [What is HTTPS? How it Works and Why It's So Important](https://www.upguard.com/blog/what-is-https)
- [What's the Difference Between HTTP vs HTTPS?](https://www.upguard.com/blog/http-vs-https)
- [what is https: the definitive guide to how https works](https://www.semrush.com/blog/what-is-https/#header3)
- [HTTP와 HTTPS의 차이점은 무엇인가요?](https://aws.amazon.com/ko/compare/the-difference-between-https-and-http/)
- [HTTPS 원리 이해하기](https://brunch.co.kr/@growthminder/79)
