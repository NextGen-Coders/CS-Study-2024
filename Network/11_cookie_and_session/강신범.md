# 쿠키와 세션

## 📋 목차

- **쿠키와 세션을 사용하는 이유**
- **쿠키 ( Cookie )**
- **세션 ( Session )**
- **쿠키와 세션의 차이**
- **쿠키와 세션 vs 캐시**

## 🥁 HTTP의 특징과 쿠키와 세션을 사용하는 이유

![cookie](https://github.com/living-in-seoul/frontend/assets/83047601/9a1d3cd0-28f7-4322-8afd-ac74a7cc81e2)

### ⚬ HTTP의 특징

**_connectless_**

- **클라이언트가 요청을 한 후 응답을 받으면 그 연결을 끊어버리는 성질**
- HTTP 1.0에서는 기본적으로 TCP 연결을 맺고 요청과 응답 후 연결이 끊어진다. (이후 HTTP 1.1에서 keep-alive 옵션을 통해 커넥션을 계속 유지하는 것이 기본값으로 변함)

**_stateless_**

- **통신이 끝나면 상태를 유지하지 않는 특징**
- 연결이 끊어지는 순간 모든 상태 정보가 사라지게 돠어 첫번째 통신 때 보낸 정보를 두 번째 통신 때 알 수 없다.

<br>

HTTP 프로토콜 환경은 **connectless**하고 **stateless**한 특성을 가지기 때문에 서버는 클라언트가 누구인지 매번 확인해야한다. 이러한 특성이자 **약점을 보완하기 위해서 쿠키 또는 세션을 사용**한다.

<br>
<br>

## 🎺 쿠키

### ⚬ 정의

클라이언트 로컬에 저장되는 키와 값이 들어있는 작은 데이터 파일로 사용자의 인증이 유효한 시간을 명시할 수 있으며, 유효시간이 정해지면 브라우저가 종료되어도 인증이 유지되는 특성이 있다.

Response Header에 Set-Cookie 속성을 사용하면 클라이언트에 쿠키를 만들 수 있고 사용자가 따로 요청하지 않아도 Request시에 Request Header에 자동으로 넣어 서버에 전송한다.

### ⚬ 특징

- 이름, 값, 만료일, 경로 정보로 구성되어 있다.
- 클라이언트에 총 300개의 쿠키를 저장할 수 있다.
- 하나의 도메인 당 20개의 쿠키를 가질 수 있다.
- 하나의 쿠키는 4KB까지 저장 가능하다

---

### ⚬ 구성 요소

- **이름**: 각각의 쿠키를 구별하는데 사용되는 이름
- **값**: 쿠키의 이름과 관련된 값
- **유효시간**: 쿠키의 유지 시간
- **도메인**: 쿠키를 전송할 도메인
- **경로**: 쿠키를 전송할 요청 경로

---

### ⚬ 동작 방식

![coookie](https://github.com/living-in-seoul/frontend/assets/83047601/f1c12fc5-a633-4903-bf65-524e0411fbf1)

1. 클라이언트가 페이지를 요청
2. 서버에서 쿠키를 생성
3. HTTP 헤더에 쿠키를 포함시켜 응답
4. 브라우저가 종료되어도 쿠키 만료 기간이 있다면 클라이언트에서 보관
5. 같은 요청을 할 경우 HTTP 헤더에 쿠키를 함께 보냄
6. 서버에서 쿠키를 읽어 이전 상태 정보를 변경할 필요가 있을 때 쿠키를 업데이트하여 변경된 쿠키를 HTTP 헤더에 포함시켜 응답

---

### ⚬ 사용 예시

- 방문 사이트에서 로그인 시, "아이디와 비밀번호를 저장하시겠습니까?"
- 쇼핑몰의 장바구니 기능
- 자동로그인, 팝업에서 "오늘은 더 이상 이 창을 보지 않음" 체크

<br>
<br>

## 🎻 세션

### ⚬ 정의

방문자가 웹 서버에 접속해 있는 상태를 하나의 단위로 보고 그것을 세션이라 하며 쿠키를 기반이지만 서버 측에서 관리하는 데이터이며 서버에서는 **클라이언트를 구분하기 위해 세션ID를 부여**하며 웹 브라우저가 브라우저를 종료할 때까지 인증상태를 유지한다는 특징이 있다.

사용자 정보를 서버에 두기에 **쿠키보다 보안에 좋지만** 메모리를 많이 차지하는 단점이 있어 **동접자 수가 많은 웹 사이트는 과부하**를 주게 되므로 성능 저하의 원인이 된다.

클라이언트가 Request를 보내면 해당 서버의 엔진이 클라이언트에게 유일한 ID를 부여하는데 이것이 세션 ID이다.

---

### ⚬ 동작 방식

![session](https://github.com/living-in-seoul/frontend/assets/83047601/a0f71301-10c8-4d30-b06e-086da9a40f13)

1. 클라이언트가 서버에 접속 시 세션 ID를 발급 받음
2. 클라이언트는 세션 ID에 대해 쿠키를 사용해서 저장하고 가지고 있는다.
3. 클라이언트는 서버에 요청할 때, 이 쿠키의 세션 ID를 같이 서버에 전달해서 요청한다.
4. 서버는 세션 ID를 전달 받아서 세션에 있는 클라이언트 정보를 가져와서 사용한다.
5. 클라이언트 정보를 가지고 서버 요청을 처리하여 클라이언트에게 응답한다.

---

### ⚬ 사용 예시

- 로그인 같이 보안상 중요한 작업을 수행할 때 사용

<br>
<br>

## 🎸 쿠키와 세션의 차이

- 세션도 쿠키를 사용하기에 동작원리는 비슷하지만 사용자의 **정보가 저장되는 위치가 다르기 때문에** 세션은 서버의 자원을 사용하는 반면 쿠키는 서버의 자원을 사용하지 않는다. (쿠키: 클라이언트, 세션: 서버)

- **세션은 서버를 사용하여 보안이 우수하나 쿠키에 비해 처리 속도가 느리다.**

- 쿠키는 파일로 저장되기에 브라우저를 종료해도 정보가 남아있을 수 있지만 **세션은 브라우저를 종료하면 만료 기간에 상관없이 삭제**된다.

<br>
<br>

## 🪇 쿠키와 세션 vs 캐시

### ⚬ 캐시란?

사용빈도가 높은 웹페이지 요소(데이터)를 저장하기 위한 임시 저장소로 대표적으로 CDN도 캐시를 이용한 시스템이다.

---

### ⚬ 캐시의 특징

- 이미지, 비디오, 오디오, css, js파일 등 데이터나 값을 미리 복사해 놓는 리소스 파일들의 임시저장소이며 저장 공간이 작고 비용이 비싸지만 빠른 성능르 제공한다.

- 같은 웹 페이지를 접속할 때나 이전에 사용된 데이터가 다시 사용될 가능성이 많으 서버를 거치지 않고 사용자의 PC의 캐시 서버에 있는 데이터를 사용하여 빠르게 접근하여 페이지의 로딩 속도를 향상시킬 수 있다.

**_캐시 히트_**: 이전에 왔던 요청이랑 같은 요청이 온 경우(캐시를 사용할 수 있는 경우)
**_캐시 미스_**: 웹 서버로 처음 요청을 한 경우 (캐시를 사요할 수 없는 경우)

<br>
<br>

## 📌 Reference

- [쿠키와 세션 개념](https://interconnection.tistory.com/74)
- [[Web] 쿠키(Cookie)와 세션(Session)의 차이, 쿠키란? 세션이란?](https://code-lab1.tistory.com/298)
- [쿠키(Cookie), 세션(Session) 특징 및 차이](https://hahahoho5915.tistory.com/32)
- [쿠키(Cookie)와 세션(Session)의 차이 (+캐시(Cache))](https://dev-coco.tistory.com/61)
- [세션 vs 쿠키 vs 캐시 차이점](https://btcd.tistory.com/40)
- [[10분 테코톡] 연로그의 쿠키 vs 세션 vs 토큰 vs 캐시](https://www.youtube.com/watch?v=gA1KsJ2ak10)
